<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visit Sri Lanka Pro</title>
    <style>
        :root { --primary: #1a73e8; --secondary: #ff9f43; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; background: var(--bg); color: #333; overflow-x: hidden; }
        
        /* Splash Screen */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #1a73e8; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 2000;
            color: white; text-align: center; transition: opacity 0.5s ease;
        }
        .splash-title { font-size: 32px; font-weight: bold; margin-bottom: 20px; text-shadow: 2px 2px 10px rgba(0,0,0,0.3); }
        .loader { width: 120px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 10px; overflow: hidden; }
        .progress { width: 0%; height: 100%; background: white; animation: load 2s forwards; }
        @keyframes load { to { width: 100%; } }

        header { background: white; padding: 15px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .search-bar { background: #eee; padding: 10px; border-radius: 10px; display: flex; align-items: center; }
        .search-bar input { border: none; background: transparent; outline: none; margin-left: 10px; width: 100%; font-size: 16px; }

        .filter-scroll { display: flex; overflow-x: auto; gap: 10px; padding: 5px 0; scrollbar-width: none; }
        .filter-scroll::-webkit-scrollbar { display: none; }
        .chip { padding: 8px 18px; background: white; border: 1px solid #ddd; border-radius: 20px; white-space: nowrap; cursor: pointer; transition: 0.3s; font-size: 14px; }
        .chip.active { background: var(--primary); color: white; border-color: var(--primary); }

        .section-title { padding: 15px; font-size: 18px; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        
        /* Featured Slider */
        .slider-container { display: flex; overflow-x: auto; gap: 15px; padding: 0 15px; scrollbar-width: none; }
        .slider-container::-webkit-scrollbar { display: none; }
        .slide-card { min-width: 280px; height: 180px; border-radius: 15px; background-size: cover; background-position: center; position: relative; color: white; display: flex; flex-direction: column; justify-content: flex-end; padding: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .slide-card::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 60%; background: linear-gradient(transparent, rgba(0,0,0,0.8)); border-radius: 15px; }
        .slide-card * { z-index: 1; position: relative; }

        /* Main Grid */
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        .card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 3px 10px rgba(0,0,0,0.05); transition: 0.3s; position: relative; }
        .card img { width: 100%; height: 120px; object-fit: cover; }
        .card-info { padding: 10px; }
        .card-info h3 { margin: 0; font-size: 14px; color: #222; height: 36px; overflow: hidden; }
        .card-info p { margin: 5px 0 0; font-size: 12px; color: #666; }
        .cat-tag { position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.6); color: white; padding: 3px 8px; border-radius: 5px; font-size: 10px; backdrop-filter: blur(5px); }

        /* Load More Button */
        #load-more-container { text-align: center; padding: 20px; }
        .btn-load { padding: 10px 25px; background: var(--primary); color: white; border: none; border-radius: 25px; font-size: 15px; cursor: pointer; box-shadow: 0 4px 10px rgba(26,115,232,0.3); }

        /* Full Overlay */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 3000; display: none; overflow-y: auto; }
        .overlay-header { position: sticky; top: 0; background: white; padding: 15px; display: flex; align-items: center; border-bottom: 1px solid #eee; }
        .back-btn { font-size: 24px; margin-right: 15px; cursor: pointer; }
        .overlay-content { padding: 20px; }
        .overlay-content img { width: 100%; border-radius: 15px; margin-bottom: 20px; }
        .detail-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .detail-icon { color: var(--primary); width: 20px; }
        .map-btn { display: block; background: #34a853; color: white; text-align: center; padding: 12px; border-radius: 10px; text-decoration: none; margin-top: 20px; font-weight: bold; }

        /* Bottom Nav */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #eee; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .nav-item { text-align: center; color: #888; cursor: pointer; font-size: 11px; }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 4px; }
        .nav-item.active { color: var(--primary); }

        /* Floating Tool Popups */
        .tool-popup { position: fixed; bottom: 70px; left: 5%; width: 90%; background: white; border-radius: 15px; padding: 20px; box-shadow: 0 5px 30px rgba(0,0,0,0.2); display: none; z-index: 4000; }
        .tool-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .close-popup { font-size: 20px; cursor: pointer; color: #666; }

        /* Toast */
        #custom-toast { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 20px; border-radius: 20px; font-size: 13px; display: none; z-index: 5000; }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <div id="splash-screen">
        <div class="splash-title">Visit Sri Lanka üá±üá∞</div>
        <div class="loader"><div class="progress"></div></div>
    </div>

    <header>
        <div class="nav-top">
            <h2 id="main-title" style="margin:0; font-size: 20px;">‡∂Ö‡∂¥‡∑ö ‡∂Ω‡∂Ç‡∂ö‡∑è Guide üá±üá∞</h2>
            <div style="background: var(--secondary); color:white; padding: 5px 12px; border-radius: 15px; font-size: 12px; font-weight: bold;">PRO</div>
        </div>
        <div class="search-bar">
            <i class="fas fa-search" style="color:#888;"></i>
            <input type="text" id="search" placeholder="‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫‡∂ö‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±..." onkeyup="searchFn()">
        </div>

        <div class="section-title" style="padding-bottom: 0;"><i class="fas fa-map-marker-alt"></i> ‡∂¥‡∑Ö‡∑è‡∂≠‡∑ä ‡∂≠‡∑ù‡∂ª‡∂±‡∑ä‡∂±</div>
        <div class="filter-scroll" id="province-filters">
            <div class="chip active" onclick="filterProvince('All', this)">‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω</div>
            <div class="chip" onclick="filterProvince('‡∂∂‡∑É‡∑ä‡∂±‡∑è‡∑Ñ‡∑í‡∂ª', this)">‡∂∂‡∑É‡∑ä‡∂±‡∑è‡∑Ñ‡∑í‡∂ª</div>
            <div class="chip" onclick="filterProvince('‡∂∏‡∂∞‡∑ä‚Äç‡∂∫‡∂∏', this)">‡∂∏‡∂∞‡∑ä‚Äç‡∂∫‡∂∏</div>
            <div class="chip" onclick="filterProvince('‡∂Ø‡∂ö‡∑î‡∂´', this)">‡∂Ø‡∂ö‡∑î‡∂´</div>
            <div class="chip" onclick="filterProvince('‡∑Ä‡∂∫‡∂π', this)">‡∑Ä‡∂∫‡∂π</div>
            <div class="chip" onclick="filterProvince('‡∑É‡∂∂‡∂ª‡∂ú‡∂∏‡∑î‡∑Ä', this)">‡∑É‡∂∂‡∂ª‡∂ú‡∂∏‡∑î‡∑Ä</div>
            <div class="chip" onclick="filterProvince('‡∂ã‡∂≠‡∑î‡∂ª', this)">‡∂ã‡∂≠‡∑î‡∂ª</div>
            <div class="chip" onclick="filterProvince('‡∂±‡∑ê‡∂ú‡∑ô‡∂±‡∑Ñ‡∑í‡∂ª', this)">‡∂±‡∑ê‡∂ú‡∑ô‡∂±‡∑Ñ‡∑í‡∂ª</div>
            <div class="chip" onclick="filterProvince('‡∂å‡∑Ä', this)">‡∂å‡∑Ä</div>
            <div class="chip" onclick="filterProvince('‡∂ã‡∂≠‡∑î‡∂ª‡∑î ‡∂∏‡∑ê‡∂Ø', this)">‡∂ã‡∂≠‡∑î‡∂ª‡∑î ‡∂∏‡∑ê‡∂Ø</div>
        </div>

        <div class="filter-scroll" id="cat-filters" style="margin-top: 8px;">
            <div class="chip active" onclick="filterCat('all', this)">‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω</div>
            <div class="chip" onclick="filterCat('culture', this)">üèõÔ∏è ‡∑É‡∂Ç‡∑É‡∑ä‡∂ö‡∑ò‡∂≠‡∑í‡∂ö</div>
            <div class="chip" onclick="filterCat('nature', this)">‚õ∞Ô∏è ‡∑É‡∑ú‡∂∂‡∑è‡∂Ø‡∑Ñ‡∂∏</div>
            <div class="chip" onclick="filterCat('beach', this)">üèñÔ∏è ‡∑Ä‡∑ô‡∂ª‡∑Ö</div>
            <div class="chip" onclick="filterCat('wild', this)">üêò ‡∑Ä‡∂±‡∂¢‡∑ì‡∑Ä‡∑ì</div>
        </div>
    </header>

    <div class="section-title"><i class="fas fa-star" style="color:var(--secondary);"></i> Featured Places</div>
    <div class="slider-container" id="slider"></div>

    <div class="section-title"><i class="fas fa-map"></i> Explore Locations</div>
    <div class="grid" id="main-grid"></div>

    <div id="load-more-container">
        <button class="btn-load" onclick="loadMore()">‡∂≠‡∑Ä‡∂≠‡∑ä ‡∂∂‡∂Ω‡∂±‡∑ä‡∂± (Load More)</button>
    </div>

    <div id="details-overlay" class="overlay">
        <div class="overlay-header">
            <div class="back-btn" onclick="closePopups()"><i class="fas fa-arrow-left"></i></div>
            <h3 id="det-title" style="margin:0;">Details</h3>
        </div>
        <div class="overlay-content" id="det-content"></div>
    </div>

    <div id="currency-tool" class="tool-popup">
        <div class="tool-header">
            <h3 id="t2-title" style="margin:0;">‡∂∏‡∑î‡∂Ø‡∂Ω‡∑ä ‡∂¥‡∂ª‡∑í‡∑Ä‡∂ª‡∑ä‡∂≠‡∂ö‡∂∫</h3>
            <div class="close-popup" onclick="closePopups()">&times;</div>
        </div>
        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <input type="number" id="foreignInput" placeholder="‡∂∏‡∑î‡∂Ø‡∂Ω" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ddd;" oninput="convertCurrency()">
            <select id="currencyList" style="padding:10px; border-radius:8px; border:1px solid #ddd;" onchange="convertCurrency()">
                <option value="USD">USD $</option>
                <option value="EUR">EUR ‚Ç¨</option>
                <option value="GBP">GBP ¬£</option>
                <option value="AUD">AUD $</option>
            </select>
        </div>
        <div style="background: #f0f7ff; padding: 15px; border-radius: 10px; text-align: center;">
            <div style="font-size: 14px; color:#666;">LKR (‡∂ª‡∑î‡∂¥‡∑í‡∂∫‡∂Ω‡∑ä)</div>
            <div id="lkrResult" style="font-size: 24px; font-weight: bold; color: var(--primary);">0.00</div>
        </div>
    </div>

    <div id="weather-tool" class="tool-popup">
        <div class="tool-header">
            <h3 id="t3-title" style="margin:0;">‡∑É‡∂¢‡∑ì‡∑Ä‡∑ì ‡∂ö‡∑è‡∂Ω‡∂ú‡∑î‡∂´‡∂∫ üå§Ô∏è</h3>
            <div class="close-popup" onclick="closePopups()">&times;</div>
        </div>
        <div id="weatherContent" style="text-align: center; padding: 10px;"></div>
    </div>

    <div id="emergency-tool" class="tool-popup">
        <div class="tool-header">
            <h3 id="t1-title" style="margin:0;">‡∑Ñ‡∂Ø‡∑í‡∑É‡∑í ‡∂á‡∂∏‡∂≠‡∑î‡∂∏‡∑ä ‡∑É‡∑ö‡∑Ä‡∑è</h3>
            <div class="close-popup" onclick="closePopups()">&times;</div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <a href="tel:119" style="text-decoration:none; background:#fee; color:#d32f2f; padding:15px; border-radius:10px; text-align:center;">
                <i class="fas fa-police-badge"></i> 119<br>Police
            </a>
            <a href="tel:1990" style="text-decoration:none; background:#e8f5e9; color:#2e7d32; padding:15px; border-radius:10px; text-align:center;">
                <i class="fas fa-ambulance"></i> 1990<br>Suwaseriya
            </a>
        </div>
    </div>

    <div style="height: 80px;"></div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="location.reload()"><i class="fas fa-home"></i>Home</div>
        <div class="nav-item" onclick="showPopup('emergency-tool')"><i class="fas fa-phone-alt"></i><span id="n1-text">Emergency</span></div>
        <div class="nav-item" onclick="showPopup('currency-tool')"><i class="fas fa-coins"></i><span id="n2-text">Currency</span></div>
        <div class="nav-item" onclick="showPopup('weather-tool'); fetchWeather();"><i class="fas fa-cloud-sun"></i><span id="n3-text">Weather</span></div>
        <div class="nav-item" onclick="toggleLang()"><i class="fas fa-language"></i>‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω / EN</div>
    </div>

    <div id="custom-toast"></div>

    <script src="translations.js"></script>
    <script>let locations = [];</script>
    <script src="locations.js"></script>
    <script src="western1.js"></script>
    <script src="western2.js"></script>
    <script src="western3.js"></script>
    <script src="western4.js"></script>

    <script>
        let currentLang = 'si';
        let itemsToShow = 6;
        let activeProvince = 'All';
        let activeCategory = 'all';

        window.onload = () => {
            setTimeout(() => {
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => document.getElementById('splash-screen').style.display = 'none', 500);
            }, 2000);
            renderAll();
        };

        function toggleLang() {
            currentLang = (currentLang === 'si') ? 'en' : 'si';
            updateUI();
            renderAll();
            showToast(currentLang === 'si' ? "‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω ‡∂∑‡∑è‡∑Ç‡∑è‡∑Ä ‡∂≠‡∑ù‡∂ª‡∑è‡∂ú‡∂≠‡∑ä‡∂≠‡∑è" : "English Language Selected");
        }

        function updateUI() {
            const t = translations[currentLang];
            document.getElementById('main-title').innerText = t.title;
            document.getElementById('search').placeholder = t.search;
            document.getElementById('n1-text').innerText = t.n1;
            document.getElementById('n2-text').innerText = t.n2;
            document.getElementById('n3-text').innerText = t.n3;
            document.getElementById('t1-title').innerText = t.t1;
            document.getElementById('t2-title').innerText = t.t2;
            document.getElementById('t3-title').innerText = t.t3;
        }

        function renderAll() {
            renderSlider();
            itemsToShow = 6; // reset on re-render
            renderGrid();
        }

        // 2. Random Slider Logic
        function renderSlider() {
            const slider = document.getElementById('slider');
            slider.innerHTML = "";
            // Shuffle and pick 3
            let shuffled = [...locations].sort(() => 0.5 - Math.random()).slice(0, 3);
            shuffled.forEach(loc => {
                let div = document.createElement('div');
                div.className = 'slide-card';
                div.style.backgroundImage = `url(${loc.img})`;
                div.onclick = () => showDetails(loc.id);
                div.innerHTML = `<h3>${currentLang === 'si' ? loc.name_si : loc.name_en}</h3>
                                <p><i class="fas fa-map-marker-alt"></i> ${currentLang === 'si' ? loc.district_si : loc.district_en}</p>`;
                slider.appendChild(div);
            });
        }

        function filterProvince(prov, btn) {
            activeProvince = prov;
            document.querySelectorAll('#province-filters .chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            itemsToShow = 6;
            renderGrid();
        }

        function filterCat(cat, btn) {
            activeCategory = cat;
            document.querySelectorAll('#cat-filters .chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            itemsToShow = 6;
            renderGrid();
        }

        // 1. Load More Logic
        function renderGrid() {
            const grid = document.getElementById('main-grid');
            grid.innerHTML = "";
            
            let filtered = locations.filter(loc => {
                let matchesProv = (activeProvince === 'All' || loc.district_si.includes(activeProvince));
                let matchesCat = (activeCategory === 'all' || loc.cat === activeCategory);
                return matchesProv && matchesCat;
            });

            let displayList = filtered.slice(0, itemsToShow);

            displayList.forEach(loc => {
                let card = document.createElement('div');
                card.className = 'card';
                card.onclick = () => showDetails(loc.id);
                card.innerHTML = `
                    <div class="cat-tag">${loc.cat.toUpperCase()}</div>
                    <img src="${loc.img}" loading="lazy">
                    <div class="card-info">
                        <h3>${currentLang === 'si' ? loc.name_si : loc.name_en}</h3>
                        <p><i class="fas fa-location-dot"></i> ${currentLang === 'si' ? loc.district_si : loc.district_en}</p>
                    </div>
                `;
                grid.appendChild(card);
            });

            // Show/Hide Load More Button
            const btnContainer = document.getElementById('load-more-container');
            if (itemsToShow < filtered.length) {
                btnContainer.style.display = "block";
            } else {
                btnContainer.style.display = "none";
            }
        }

        function loadMore() {
            itemsToShow += 6;
            renderGrid();
        }

        function showDetails(id) {
            const loc = locations.find(l => l.id === id);
            const t = translations[currentLang];
            document.getElementById('det-title').innerText = (currentLang === 'si' ? loc.name_si : loc.name_en);
            document.getElementById('det-content').innerHTML = `
                <img src="${loc.img}">
                <div class="detail-row"><i class="fas fa-map-marker-alt detail-icon"></i> <div><strong>${t.loc}</strong><br>${currentLang === 'si' ? loc.district_si : loc.district_en}</div></div>
                <div class="detail-row"><i class="fas fa-info-circle detail-icon"></i> <div><strong>${t.about}</strong><br>${currentLang === 'si' ? loc.desc_si : loc.desc_en}</div></div>
                <div class="detail-row"><i class="fas fa-bus detail-icon"></i> <div><strong>${t.how}</strong><br>${currentLang === 'si' ? loc.reach_si : loc.reach_en}</div></div>
                <div class="detail-row"><i class="fas fa-clock detail-icon"></i> <div><strong>Best Time:</strong> ${currentLang === 'si' ? loc.best_si : loc.best_en}</div></div>
                <div class="detail-row"><i class="fas fa-ticket detail-icon"></i> <div><strong>Fee:</strong> ${currentLang === 'si' ? loc.fee_si : loc.fee_en}</div></div>
                <div class="detail-row"><i class="fas fa-phone-volume detail-icon"></i> <div><strong>${t.contact}</strong><br>${loc.police}</div></div>
                <a href="https://www.google.com/maps?q=${loc.lat},${loc.lon}" class="map-btn" target="_blank">${t.map}</a>
            `;
            showPopup('details-overlay');
        }

        function showPopup(id) { 
            closePopups();
            document.getElementById(id).style.display = "block"; 
        }
        function closePopups() { 
            document.querySelectorAll('.overlay, .tool-popup').forEach(el => el.style.display = 'none'); 
        }
        function showToast(msg) { 
            const toast = document.getElementById('custom-toast'); 
            toast.innerText = msg; toast.style.display = 'block'; 
            setTimeout(() => { toast.style.display = 'none'; }, 2000); 
        }

        function searchFn() {
            let input = document.getElementById('search').value.toLowerCase();
            if(input.length > 0) {
                itemsToShow = 1000; // Search all
            } else {
                itemsToShow = 6;
            }
            renderGrid();
        }

        async function convertCurrency() {
            const amount = document.getElementById('foreignInput').value;
            const fromCurrency = document.getElementById('currencyList').value;
            const resultEl = document.getElementById('lkrResult');
            if (!amount || amount <= 0) { resultEl.innerText = "0.00"; return; }
            try {
                const res = await fetch(`https://open.er-api.com/v6/latest/${fromCurrency}`);
                const data = await res.json();
                resultEl.innerText = (amount * data.rates.LKR).toLocaleString();
            } catch (e) { resultEl.innerText = "Error"; }
        }

        async function fetchWeather() {
            const weatherBox = document.getElementById('weatherContent');
            weatherBox.innerHTML = translations[currentLang].loading;
            try {
                const res = await fetch(`https://api.open-meteo.com/1/v1/forecast?latitude=6.9271&longitude=79.8612&current_weather=true`);
                const data = await res.json();
                const temp = Math.round(data.current_weather.temperature);
                weatherBox.innerHTML = `<div style="font-size:40px;">üå§Ô∏è ${temp}¬∞C</div><p>Colombo, Sri Lanka</p>`;
            } catch (e) { weatherBox.innerHTML = "Weather Load Error"; }
        }
    </script>
</body>
</html>
