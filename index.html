<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visit Sri Lanka Pro</title>
    <style>
        :root { --primary: #1a73e8; --secondary: #ff9f43; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; background: var(--bg); color: #333; overflow-x: hidden; }
        
        /* Splash Screen */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #1a73e8; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 2000;
            color: white; text-align: center; transition: opacity 0.5s ease;
        }
        .splash-title { font-size: 32px; font-weight: bold; margin-bottom: 20px; text-shadow: 2px 2px 10px rgba(0,0,0,0.3); }
        .loader { width: 120px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 10px; overflow: hidden; }
        .progress { width: 0%; height: 100%; background: white; animation: load 2s forwards; }
        @keyframes load { to { width: 100%; } }

        header { background: white; padding: 15px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .nav-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .search-bar { background: #eee; padding: 10px; border-radius: 10px; display: flex; align-items: center; }
        .search-bar input { border: none; background: transparent; outline: none; margin-left: 10px; width: 100%; font-size: 16px; }

        .filter-scroll { display: flex; overflow-x: auto; gap: 10px; padding: 5px 0; scrollbar-width: none; }
        .filter-scroll::-webkit-scrollbar { display: none; }
        .chip { padding: 8px 18px; background: white; border: 1px solid #ddd; border-radius: 20px; white-space: nowrap; cursor: pointer; transition: 0.3s; font-size: 14px; }
        .chip.active { background: var(--primary); color: white; border-color: var(--primary); }

        .section-title { padding: 15px; font-size: 18px; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        
        /* Featured Slider */
        .slider-container { display: flex; overflow-x: auto; gap: 15px; padding: 0 15px; scrollbar-width: none; }
        .slider-container::-webkit-scrollbar { display: none; }
        .slide-card { min-width: 280px; height: 180px; border-radius: 15px; background-size: cover; background-position: center; position: relative; color: white; display: flex; flex-direction: column; justify-content: flex-end; padding: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .slide-card::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 60%; background: linear-gradient(transparent, rgba(0,0,0,0.8)); border-radius: 15px; }
        .slide-card * { z-index: 1; position: relative; }

        /* Main Grid */
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        .card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 3px 10px rgba(0,0,0,0.05); transition: 0.3s; position: relative; }
        .card img { width: 100%; height: 120px; object-fit: cover; }
        .card-info { padding: 10px; }
        .card-info h3 { margin: 0; font-size: 14px; color: #222; height: 36px; overflow: hidden; }
        .card-info p { margin: 5px 0 0; font-size: 12px; color: #666; }
        .cat-tag { position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.6); color: white; padding: 3px 8px; border-radius: 5px; font-size: 10px; backdrop-filter: blur(5px); }

        /* Load More Button Styles */
        #load-more-container { text-align: center; padding: 20px 15px 40px; }
        .load-btn { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 25px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        /* Overlays */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 3000; display: none; overflow-y: auto; }
        .overlay-header { position: sticky; top: 0; background: white; padding: 15px; display: flex; align-items: center; border-bottom: 1px solid #eee; }
        .back-btn { font-size: 24px; margin-right: 15px; cursor: pointer; }
        .overlay-content { padding: 20px; }
        .overlay-content img { width: 100%; border-radius: 15px; margin-bottom: 20px; }
        .detail-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .detail-icon { color: var(--primary); width: 20px; }
        .map-btn { display: block; background: #34a853; color: white; text-align: center; padding: 12px; border-radius: 10px; text-decoration: none; margin-top: 20px; font-weight: bold; }

        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #eee; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }
        .nav-item { text-align: center; color: #888; cursor: pointer; font-size: 11px; }
        .nav-item i { font-size: 20px; display: block; margin-bottom: 4px; }
        .nav-item.active { color: var(--primary); }

        #custom-toast { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 8px 20px; border-radius: 20px; font-size: 13px; display: none; z-index: 5000; }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <div id="splash-screen">
        <div class="splash-title">Visit Sri Lanka üá±üá∞</div>
        <div class="loader"><div class="progress"></div></div>
    </div>

    <header>
        <div class="nav-top">
            <h2 id="main-title" style="margin:0; font-size: 20px;">‡∂Ö‡∂¥‡∑ö ‡∂Ω‡∂Ç‡∂ö‡∑è Guide üá±üá∞</h2>
            <div style="background: var(--secondary); color:white; padding: 5px 12px; border-radius: 15px; font-size: 12px; font-weight: bold;">PRO</div>
        </div>
        <div class="search-bar">
            <i class="fas fa-search" style="color:#888;"></i>
            <input type="text" id="search" placeholder="‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫‡∂ö‡∑ä ‡∑É‡∑ú‡∂∫‡∂±‡∑ä‡∂±..." onkeyup="searchFn()">
        </div>

        <div class="filter-scroll" id="province-filters" style="margin-top: 10px;">
            <div class="chip active" onclick="filterByProvince('‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω', this)">‡∑É‡∑í‡∂∫‡∂Ω‡∑î ‡∂¥‡∑Ö‡∑è‡∂≠‡∑ä</div>
            <div class="chip" onclick="filterByProvince('‡∂ö‡∑ú‡∑Ö‡∂π', this)">‡∂∂‡∑É‡∑ä‡∂±‡∑è‡∑Ñ‡∑í‡∂ª</div>
            <div class="chip" onclick="filterByProvince('‡∂∏‡∑Ñ‡∂±‡∑î‡∑Ä‡∂ª', this)">‡∂∏‡∂∞‡∑ä‚Äç‡∂∫‡∂∏</div>
            <div class="chip" onclick="filterByProvince('‡∂ú‡∑è‡∂Ω‡∑ä‡∂Ω', this)">‡∂Ø‡∂ö‡∑î‡∂´</div>
            <div class="chip" onclick="filterByProvince('‡∂∫‡∑è‡∂¥‡∂±‡∂∫', this)">‡∂ã‡∂≠‡∑î‡∂ª</div>
            <div class="chip" onclick="filterByProvince('‡∂≠‡∑ä‚Äç‡∂ª‡∑í‡∂ö‡∑î‡∂´‡∑è‡∂∏‡∂Ω‡∂∫', this)">‡∂±‡∑ê‡∂ú‡∑ô‡∂±‡∑Ñ‡∑í‡∂ª</div>
            <div class="chip" onclick="filterByProvince('‡∂ö‡∑î‡∂ª‡∑î‡∂´‡∑ë‡∂ú‡∂Ω', this)">‡∑Ä‡∂∫‡∂π</div>
            <div class="chip" onclick="filterByProvince('‡∂Ö‡∂±‡∑î‡∂ª‡∑è‡∂∞‡∂¥‡∑î‡∂ª‡∂∫', this)">‡∂ã‡∂≠‡∑î‡∂ª‡∑î ‡∂∏‡∑ê‡∂Ø</div>
            <div class="chip" onclick="filterByProvince('‡∂∂‡∂Ø‡∑î‡∂Ω‡∑ä‡∂Ω', this)">‡∂å‡∑Ä</div>
            <div class="chip" onclick="filterByProvince('‡∂ª‡∂≠‡∑ä‡∂±‡∂¥‡∑î‡∂ª‡∂∫', this)">‡∑É‡∂∂‡∂ª‡∂ú‡∂∏‡∑î‡∑Ä</div>
        </div>

        <div class="filter-scroll" id="cat-filters" style="margin-top: 5px;">
            <div class="chip active" onclick="filterCat('all', this)">‡∑É‡∑í‡∂∫‡∂Ω‡∑î ‡∑Ä‡∂ª‡∑ä‡∂ú</div>
            <div class="chip" onclick="filterCat('culture', this)">üèõÔ∏è ‡∑É‡∂Ç‡∑É‡∑ä‡∂ö‡∑ò‡∂≠‡∑í‡∂ö</div>
            <div class="chip" onclick="filterCat('nature', this)">‚õ∞Ô∏è ‡∑É‡∑ú‡∂∂‡∑è‡∂Ø‡∑Ñ‡∂∏</div>
            <div class="chip" onclick="filterCat('beach', this)">üèñÔ∏è ‡∑Ä‡∑ô‡∂ª‡∑Ö</div>
            <div class="chip" onclick="filterCat('wild', this)">üêò ‡∑Ä‡∂±‡∂¢‡∑ì‡∑Ä‡∑ì</div>
        </div>
    </header>

    <div class="section-title"><i class="fas fa-star" style="color:var(--secondary);"></i> ‡∂±‡∑í‡∂ª‡∑ä‡∂Ø‡∑ö‡∑Å‡∑í‡∂≠ ‡∑É‡∑ä‡∂Æ‡∑è‡∂±</div>
    <div class="slider-container" id="slider"></div>

    <div class="section-title"><i class="fas fa-map"></i> ‡∑É‡∑í‡∂∫‡∂Ω‡∑î ‡∑É‡∑ä‡∂Æ‡∑è‡∂±</div>
    <div class="grid" id="main-grid"></div>

    <div id="load-more-container">
        <button class="load-btn" onclick="loadMore()">‡∂≠‡∑Ä‡∂≠‡∑ä ‡∑É‡∑ä‡∂Æ‡∑è‡∂± ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂±‡∑ä‡∂±</button>
    </div>

    <div id="details-overlay" class="overlay">
        <div class="overlay-header">
            <div class="back-btn" onclick="closePopups()"><i class="fas fa-arrow-left"></i></div>
            <h3 id="det-title" style="margin:0;">Details</h3>
        </div>
        <div class="overlay-content" id="det-content"></div>
    </div>

    <div style="height: 80px;"></div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="location.reload()"><i class="fas fa-home"></i>Home</div>
        <div class="nav-item" onclick="toggleLang()"><i class="fas fa-language"></i>‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω / EN</div>
    </div>

    <div id="custom-toast"></div>

    <script src="translations.js"></script>
    <script>let locations = [];</script>
    <script src="locations.js"></script>
    <script src="western1.js"></script>
    <script src="western2.js"></script>
    <script src="western3.js"></script>
    <script src="western4.js"></script>

    <script>
        let currentLang = 'si';
        let visibleCount = 6;
        let activeCategory = 'all';
        let activeProvince = '‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω';

        window.onload = () => {
            setTimeout(() => {
                document.getElementById('splash-screen').style.opacity = '0';
                setTimeout(() => document.getElementById('splash-screen').style.display = 'none', 500);
            }, 2000);
            renderAll();
        };

        function renderAll() {
            renderSlider();
            renderGrid();
        }

        // 2. ‡∑Ä‡∂ª‡∑í‡∂±‡∑ä ‡∑Ä‡∂ª ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∑Ä‡∂± Slide ‡∂ë‡∂ö (Random)
        function renderSlider() {
            const slider = document.getElementById('slider');
            slider.innerHTML = "";
            let shuffled = [...locations].sort(() => 0.5 - Math.random());
            let featured = shuffled.slice(0, 5); // ‡∑É‡∑ä‡∂Æ‡∑è‡∂± 5‡∂ö‡∑ä ‡∑É‡∑É‡∂∏‡∑ä‡∂∑‡∑è‡∑Ä‡∑ì‡∑Ä ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂∫‡∑í

            featured.forEach(loc => {
                let div = document.createElement('div');
                div.className = 'slide-card';
                div.style.backgroundImage = `url(${loc.img})`;
                div.onclick = () => showDetails(loc.id);
                div.innerHTML = `
                    <h3>${currentLang === 'si' ? loc.name_si : loc.name_en}</h3>
                    <p><i class="fas fa-map-marker-alt"></i> ${currentLang === 'si' ? loc.district_si : loc.district_en}</p>
                `;
                slider.appendChild(div);
            });
        }

        // 3. ‡∂¥‡∑Ö‡∑è‡∂≠‡∑ä ‡∑Ä‡∂ª‡∑ä‡∂ú‡∑ì‡∂ö‡∂ª‡∂´‡∂∫
        function filterByProvince(prov, btn) {
            activeProvince = prov;
            document.querySelectorAll('#province-filters .chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            visibleCount = 6; 
            renderGrid();
        }

        function filterCat(cat, btn) {
            activeCategory = cat;
            document.querySelectorAll('#cat-filters .chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            visibleCount = 6;
            renderGrid();
        }

        // 1. ‡∂≠‡∑Ä‡∂≠‡∑ä ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂±‡∑ä‡∂± (Load More) ‡∂ö‡∑ä‚Äç‡∂ª‡∂∏‡∂∫
        function renderGrid() {
            const grid = document.getElementById('main-grid');
            grid.innerHTML = "";
            
            let filtered = locations.filter(loc => {
                let catMatch = activeCategory === 'all' || loc.cat === activeCategory;
                let provMatch = activeProvince === '‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω' || loc.district_si.includes(activeProvince) || loc.district_en.includes(activeProvince);
                return catMatch && provMatch;
            });

            let toDisplay = filtered.slice(0, visibleCount);

            toDisplay.forEach(loc => {
                let card = document.createElement('div');
                card.className = 'card';
                card.onclick = () => showDetails(loc.id);
                card.innerHTML = `
                    <div class="cat-tag">${loc.cat.toUpperCase()}</div>
                    <img src="${loc.img}" loading="lazy">
                    <div class="card-info">
                        <h3>${currentLang === 'si' ? loc.name_si : loc.name_en}</h3>
                        <p><i class="fas fa-location-dot"></i> ${currentLang === 'si' ? loc.district_si : loc.district_en}</p>
                    </div>
                `;
                grid.appendChild(card);
            });

            // ‡∂∂‡∑ú‡∂≠‡∑ä‡∂≠‡∂∏ ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∑ì‡∂∏ ‡∑Ñ‡∑ù ‡∑É‡∑ê‡∂ü‡∑Ä‡∑ì‡∂∏
            const loadMoreBtn = document.getElementById('load-more-container');
            if (visibleCount < filtered.length) {
                loadMoreBtn.style.display = 'block';
            } else {
                loadMoreBtn.style.display = 'none';
            }
        }

        function loadMore() {
            visibleCount += 6;
            renderGrid();
        }

        function showDetails(id) {
            const loc = locations.find(l => l.id === id);
            const t = translations[currentLang];
            document.getElementById('det-title').innerText = (currentLang === 'si' ? loc.name_si : loc.name_en);
            document.getElementById('det-content').innerHTML = `
                <img src="${loc.img}">
                <div class="detail-row"><i class="fas fa-map-marker-alt detail-icon"></i> <div><strong>${t.loc}</strong><br>${currentLang === 'si' ? loc.district_si : loc.district_en}</div></div>
                <div class="detail-row"><i class="fas fa-info-circle detail-icon"></i> <div><strong>${t.about}</strong><br>${currentLang === 'si' ? loc.desc_si : loc.desc_en}</div></div>
                <div class="detail-row"><i class="fas fa-bus detail-icon"></i> <div><strong>${t.how}</strong><br>${currentLang === 'si' ? loc.reach_si : loc.reach_en}</div></div>
                <div class="detail-row"><i class="fas fa-phone-volume detail-icon"></i> <div><strong>${t.contact}</strong><br>${loc.police}</div></div>
                <a href="https://www.google.com/maps/search/?api=1&query=${loc.lat},${loc.lon}" class="map-btn" target="_blank">${t.map}</a>
            `;
            document.getElementById('details-overlay').style.display = "block";
        }

        function closePopups() {
            document.querySelectorAll('.overlay').forEach(el => el.style.display = 'none');
        }

        function searchFn() {
            let input = document.getElementById('search').value.toLowerCase();
            if (input === "") {
                visibleCount = 6;
            } else {
                visibleCount = locations.length; // ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏‡∑ö‡∂Ø‡∑ì ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∂ª‡∂∫‡∑í
            }
            renderGrid();
        }

        function toggleLang() {
            currentLang = (currentLang === 'si') ? 'en' : 'si';
            renderAll();
        }
    </script>
</body>
</html>
